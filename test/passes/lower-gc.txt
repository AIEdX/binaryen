add mem
add run
comp layouts
lower code
(module
 (type $i32_=>_i32 (func (param i32) (result i32)))
 (type $i32_i32_=>_none (func (param i32 i32)))
 (type $i32_i32_=>_i32 (func (param i32 i32) (result i32)))
 (type $type$0 (func))
 (type $i32_i32_i32_i32_i32_i32_=>_none (func (param i32 i32 i32 i32 i32 i32)))
 (type $i32_f64_=>_none (func (param i32 f64)))
 (type $i32_f32_=>_none (func (param i32 f32)))
 (type $i32_=>_f64 (func (param i32) (result f64)))
 (type $i32_=>_f32 (func (param i32) (result f32)))
 (type $i32_=>_none (func (param i32)))
 (type $i32_f64_f32_i32_=>_i32 (func (param i32 f64 f32 i32) (result i32)))
 (type $i64_i32_=>_i32 (func (param i64 i32) (result i32)))
 (type $i32_i64_=>_none (func (param i32 i64)))
 (type $i32_=>_i64 (func (param i32) (result i64)))
 (type $f32_i32_=>_i32 (func (param f32 i32) (result i32)))
 (type $f64_i32_=>_i32 (func (param f64 i32) (result i32)))
 (type $i32_i32_i32_=>_i32 (func (param i32 i32 i32) (result i32)))
 (type $i32_i32_i32_=>_none (func (param i32 i32 i32)))
 (type $f64_i32_i32_=>_i32 (func (param f64 i32 i32) (result i32)))
 (type $i32_i32_f64_=>_none (func (param i32 i32 f64)))
 (type $i32_i32_=>_f64 (func (param i32 i32) (result f64)))
 (global $nextMalloc (mut i32) (i32.const 8))
 (memory $0 256 256)
 (func $struct-gets (param $ref-i32 i32) (param $ref-i64 i32) (param $ref-f32 i32) (param $ref-f64 i32) (param $ref-ref i32) (param $ref-rtt i32)
  (drop
   (call $StructGet$struct-i32$0
    (local.get $ref-i32)
   )
  )
  (drop
   (call $StructGet$struct-i64$0
    (local.get $ref-i64)
   )
  )
  (drop
   (call $StructGet$struct-f32$0
    (local.get $ref-f32)
   )
  )
  (drop
   (call $StructGet$struct-f64$0
    (local.get $ref-f64)
   )
  )
  (drop
   (call $StructGet$struct-ref$0
    (local.get $ref-ref)
   )
  )
  (drop
   (call $StructGet$struct-rtt$0
    (local.get $ref-rtt)
   )
  )
 )
 (func $struct-sets (param $ref-i32 i32) (param $ref-i64 i32) (param $ref-f32 i32) (param $ref-f64 i32) (param $ref-ref i32) (param $ref-rtt i32)
  (call $StructSet$struct-i32$0
   (local.get $ref-i32)
   (i32.const 0)
  )
  (call $StructSet$struct-i64$0
   (local.get $ref-i64)
   (i64.const 0)
  )
  (call $StructSet$struct-f32$0
   (local.get $ref-f32)
   (f32.const 0)
  )
  (call $StructSet$struct-f64$0
   (local.get $ref-f64)
   (f64.const 0)
  )
  (call $StructSet$struct-ref$0
   (local.get $ref-ref)
   (i32.const 0)
  )
  (call $StructSet$struct-rtt$0
   (local.get $ref-rtt)
   (i32.const 0)
  )
 )
 (func $many-fields (param $ref i32)
  (call $StructSet$many-fields$0
   (local.get $ref)
   (i32.const 1)
  )
  (call $StructSet$many-fields$1
   (local.get $ref)
   (f64.const 3.14159)
  )
  (call $StructSet$many-fields$2
   (local.get $ref)
   (f32.const 2.718280076980591)
  )
 )
 (func $new-struct
  (drop
   (call $StructNew$struct-i32
    (i32.const 42)
    (i32.const 0)
   )
  )
 )
 (func $new-struct-default
  (drop
   (call $StructNewWithDefault$many-fields
    (i32.const 0)
   )
  )
 )
 (func $array-gets (param $ref-bytes i32) (param $ref-doubles i32)
  (drop
   (call $ArrayGet$bytes
    (local.get $ref-bytes)
    (i32.const 7)
   )
  )
  (drop
   (call $ArrayGet$doubles
    (local.get $ref-doubles)
    (i32.const 7)
   )
  )
 )
 (func $array-sets (param $ref-bytes i32) (param $ref-doubles i32)
  (call $ArraySet$bytes
   (local.get $ref-bytes)
   (i32.const 7)
   (i32.const 42)
  )
  (call $ArraySet$doubles
   (local.get $ref-doubles)
   (i32.const 7)
   (f64.const 3.14159)
  )
 )
 (func $new-array
  (drop
   (call $ArrayNew$bytes
    (i32.const 42)
    (i32.const 11)
    (i32.const 0)
   )
  )
 )
 (func $new-array-default
  (drop
   (call $ArrayNewWithDefault$doubles
    (i32.const 11)
    (i32.const 0)
   )
  )
 )
 (func $malloc (param $0 i32) (result i32)
  (global.set $nextMalloc
   (i32.add
    (global.get $nextMalloc)
    (local.get $0)
   )
  )
  (i32.sub
   (global.get $nextMalloc)
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$many-fields (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 20)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$many-fields$0
   (local.get $1)
   (i32.const 0)
  )
  (call $StructSet$many-fields$1
   (local.get $1)
   (f64.const 0)
  )
  (call $StructSet$many-fields$2
   (local.get $1)
   (f32.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$many-fields (param $0 i32) (param $1 f64) (param $2 f32) (param $3 i32) (result i32)
  (local $4 i32)
  (local.set $4
   (call $malloc
    (i32.const 20)
   )
  )
  (i32.store
   (local.get $4)
   (local.get $3)
  )
  (call $StructSet$many-fields$0
   (local.get $4)
   (local.get $0)
  )
  (call $StructSet$many-fields$1
   (local.get $4)
   (local.get $1)
  )
  (call $StructSet$many-fields$2
   (local.get $4)
   (local.get $2)
  )
  (local.get $4)
 )
 (func $StructSet$many-fields$0 (param $0 i32) (param $1 i32)
  (i32.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructSet$many-fields$1 (param $0 i32) (param $1 f64)
  (f64.store offset=8
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructSet$many-fields$2 (param $0 i32) (param $1 f32)
  (f32.store offset=16
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$many-fields$0 (param $0 i32) (result i32)
  (i32.load offset=4
   (local.get $0)
  )
 )
 (func $StructGet$many-fields$1 (param $0 i32) (result f64)
  (f64.load offset=8
   (local.get $0)
  )
 )
 (func $StructGet$many-fields$2 (param $0 i32) (result f32)
  (f32.load offset=16
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$struct-i32 (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-i32$0
   (local.get $1)
   (i32.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-i32 (param $0 i32) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-i32$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-i32$0 (param $0 i32) (param $1 i32)
  (i32.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-i32$0 (param $0 i32) (result i32)
  (i32.load offset=4
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$empty (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 4)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (local.get $1)
 )
 (func $StructNew$empty (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 4)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (local.get $1)
 )
 (func $StructNewWithDefault$struct-i64 (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 12)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-i64$0
   (local.get $1)
   (i64.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-i64 (param $0 i64) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 12)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-i64$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-i64$0 (param $0 i32) (param $1 i64)
  (i64.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-i64$0 (param $0 i32) (result i64)
  (i64.load offset=4
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$struct-f32 (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-f32$0
   (local.get $1)
   (f32.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-f32 (param $0 f32) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-f32$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-f32$0 (param $0 i32) (param $1 f32)
  (f32.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-f32$0 (param $0 i32) (result f32)
  (f32.load offset=4
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$struct-f64 (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 12)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-f64$0
   (local.get $1)
   (f64.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-f64 (param $0 f64) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 12)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-f64$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-f64$0 (param $0 i32) (param $1 f64)
  (f64.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-f64$0 (param $0 i32) (result f64)
  (f64.load offset=4
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$struct-ref (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-ref$0
   (local.get $1)
   (i32.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-ref (param $0 i32) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-ref$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-ref$0 (param $0 i32) (param $1 i32)
  (i32.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-ref$0 (param $0 i32) (result i32)
  (i32.load offset=4
   (local.get $0)
  )
 )
 (func $StructNewWithDefault$struct-rtt (param $0 i32) (result i32)
  (local $1 i32)
  (local.set $1
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $1)
   (local.get $0)
  )
  (call $StructSet$struct-rtt$0
   (local.get $1)
   (i32.const 0)
  )
  (local.get $1)
 )
 (func $StructNew$struct-rtt (param $0 i32) (param $1 i32) (result i32)
  (local $2 i32)
  (local.set $2
   (call $malloc
    (i32.const 8)
   )
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (call $StructSet$struct-rtt$0
   (local.get $2)
   (local.get $0)
  )
  (local.get $2)
 )
 (func $StructSet$struct-rtt$0 (param $0 i32) (param $1 i32)
  (i32.store offset=4
   (local.get $0)
   (local.get $1)
  )
 )
 (func $StructGet$struct-rtt$0 (param $0 i32) (result i32)
  (i32.load offset=4
   (local.get $0)
  )
 )
 (func $ArrayNewWithDefault$bytes (param $0 i32) (param $1 i32) (result i32)
  (local $2 i32)
  (local $3 i32)
  (local.set $2
   (call $malloc
    (i32.const 0)
   )
  )
  (i32.store offset=4
   (local.get $2)
   (local.get $0)
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (loop $loop
   (block $block
    (br_if $loop
     (i32.eqz
      (local.get $3)
     )
    )
    (call $ArraySet$bytes
     (local.get $2)
     (local.get $3)
     (i32.const 0)
    )
    (local.set $3
     (i32.sub
      (local.get $3)
      (i32.const 1)
     )
    )
    (br $loop)
   )
  )
  (local.get $2)
 )
 (func $ArrayNew$bytes (param $0 i32) (param $1 i32) (param $2 i32) (result i32)
  (local $3 i32)
  (local $4 i32)
  (local.set $3
   (call $malloc
    (i32.const 0)
   )
  )
  (i32.store offset=4
   (local.get $3)
   (local.get $1)
  )
  (i32.store
   (local.get $3)
   (local.get $2)
  )
  (loop $loop
   (block $block
    (br_if $loop
     (i32.eqz
      (local.get $4)
     )
    )
    (call $ArraySet$bytes
     (local.get $3)
     (local.get $4)
     (local.get $0)
    )
    (local.set $4
     (i32.sub
      (local.get $4)
      (i32.const 1)
     )
    )
    (br $loop)
   )
  )
  (local.get $3)
 )
 (func $ArraySet$bytes (param $0 i32) (param $1 i32) (param $2 i32)
  (i32.store
   (i32.add
    (i32.add
     (local.get $0)
     (i32.const 8)
    )
    (i32.mul
     (i32.const 4)
     (local.get $1)
    )
   )
   (local.get $2)
  )
 )
 (func $ArrayGet$bytes (param $0 i32) (param $1 i32) (result i32)
  (i32.load
   (i32.add
    (i32.add
     (local.get $0)
     (i32.const 8)
    )
    (i32.mul
     (i32.const 4)
     (local.get $1)
    )
   )
  )
 )
 (func $ArrayNewWithDefault$doubles (param $0 i32) (param $1 i32) (result i32)
  (local $2 i32)
  (local $3 i32)
  (local.set $2
   (call $malloc
    (i32.const 0)
   )
  )
  (i32.store offset=4
   (local.get $2)
   (local.get $0)
  )
  (i32.store
   (local.get $2)
   (local.get $1)
  )
  (loop $loop
   (block $block
    (br_if $loop
     (i32.eqz
      (local.get $3)
     )
    )
    (call $ArraySet$doubles
     (local.get $2)
     (local.get $3)
     (f64.const 0)
    )
    (local.set $3
     (i32.sub
      (local.get $3)
      (i32.const 1)
     )
    )
    (br $loop)
   )
  )
  (local.get $2)
 )
 (func $ArrayNew$doubles (param $0 f64) (param $1 i32) (param $2 i32) (result i32)
  (local $3 i32)
  (local $4 i32)
  (local.set $3
   (call $malloc
    (i32.const 0)
   )
  )
  (i32.store offset=4
   (local.get $3)
   (local.get $1)
  )
  (i32.store
   (local.get $3)
   (local.get $2)
  )
  (loop $loop
   (block $block
    (br_if $loop
     (i32.eqz
      (local.get $4)
     )
    )
    (call $ArraySet$doubles
     (local.get $3)
     (local.get $4)
     (local.get $0)
    )
    (local.set $4
     (i32.sub
      (local.get $4)
      (i32.const 1)
     )
    )
    (br $loop)
   )
  )
  (local.get $3)
 )
 (func $ArraySet$doubles (param $0 i32) (param $1 i32) (param $2 f64)
  (f64.store
   (i32.add
    (i32.add
     (local.get $0)
     (i32.const 8)
    )
    (i32.mul
     (i32.const 8)
     (local.get $1)
    )
   )
   (local.get $2)
  )
 )
 (func $ArrayGet$doubles (param $0 i32) (param $1 i32) (result f64)
  (f64.load
   (i32.add
    (i32.add
     (local.get $0)
     (i32.const 8)
    )
    (i32.mul
     (i32.const 8)
     (local.get $1)
    )
   )
  )
 )
)
